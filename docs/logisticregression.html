<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.113">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Stan and R for Pharmacometrics - 4&nbsp; Logistic Regression Using brms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: 1;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./installation.html" rel="next">
<link href="./poppk.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Logistic Regression Using <code>brms</code></span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Stan and R for Pharmacometrics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/StanPMx/stanpmx.github.io" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">About the Authors</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Chapters</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Bayesian Methods for Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stancodeblocks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Stan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./poppk.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Bayesian Approach to PK/PD using Stan and Torsten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logisticregression.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Logistic Regression Using <code>brms</code></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Support</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installation.html" class="sidebar-item-text sidebar-link">Installation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logreg_ho_solution.html" class="sidebar-item-text sidebar-link">Logistic Regression Hands-On With Solution</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-relevant-libraries" id="toc-load-relevant-libraries" class="nav-link active" data-scroll-target="#load-relevant-libraries"><span class="toc-section-number">4.1</span>  Load Relevant Libraries</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="toc-section-number">4.2</span>  Logistic Regression</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="toc-section-number">4.3</span>  Import Data</a></li>
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing"><span class="toc-section-number">4.4</span>  Data Processing</a></li>
  <li><a href="#data-summary" id="toc-data-summary" class="nav-link" data-scroll-target="#data-summary"><span class="toc-section-number">4.5</span>  Data Summary</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration"><span class="toc-section-number">4.6</span>  Data Exploration</a></li>
  <li><a href="#model-fit" id="toc-model-fit" class="nav-link" data-scroll-target="#model-fit"><span class="toc-section-number">4.7</span>  Model Fit</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation"><span class="toc-section-number">4.8</span>  Model Evaluation</a>
  <ul class="collapse">
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="toc-section-number">4.8.1</span>  Summary</a></li>
  <li><a href="#model-convergence" id="toc-model-convergence" class="nav-link" data-scroll-target="#model-convergence"><span class="toc-section-number">4.8.2</span>  Model Convergence</a></li>
  </ul></li>
  <li><a href="#frequentist-approach" id="toc-frequentist-approach" class="nav-link" data-scroll-target="#frequentist-approach"><span class="toc-section-number">4.9</span>  Frequentist Approach</a></li>
  <li><a href="#priors" id="toc-priors" class="nav-link" data-scroll-target="#priors"><span class="toc-section-number">4.10</span>  Priors</a>
  <ul class="collapse">
  <li><a href="#set-up-priors" id="toc-set-up-priors" class="nav-link" data-scroll-target="#set-up-priors"><span class="toc-section-number">4.10.1</span>  Set Up Priors</a></li>
  <li><a href="#model-fit-with-priors" id="toc-model-fit-with-priors" class="nav-link" data-scroll-target="#model-fit-with-priors"><span class="toc-section-number">4.10.2</span>  Model Fit with Priors</a></li>
  <li><a href="#compare-prior-and-posterior-samples" id="toc-compare-prior-and-posterior-samples" class="nav-link" data-scroll-target="#compare-prior-and-posterior-samples"><span class="toc-section-number">4.10.3</span>  Compare Prior and Posterior Samples</a></li>
  </ul></li>
  <li><a href="#hands-on-example" id="toc-hands-on-example" class="nav-link" data-scroll-target="#hands-on-example"><span class="toc-section-number">4.11</span>  Hands-On Example</a>
  <ul class="collapse">
  <li><a href="#import-dataset" id="toc-import-dataset" class="nav-link" data-scroll-target="#import-dataset"><span class="toc-section-number">4.11.1</span>  Import Dataset</a></li>
  <li><a href="#data-processing-1" id="toc-data-processing-1" class="nav-link" data-scroll-target="#data-processing-1"><span class="toc-section-number">4.11.2</span>  Data Processing</a></li>
  <li><a href="#data-summary-1" id="toc-data-summary-1" class="nav-link" data-scroll-target="#data-summary-1"><span class="toc-section-number">4.11.3</span>  Data Summary</a></li>
  <li><a href="#model-fit-1" id="toc-model-fit-1" class="nav-link" data-scroll-target="#model-fit-1"><span class="toc-section-number">4.11.4</span>  Model Fit</a></li>
  <li><a href="#model-evaluation-1" id="toc-model-evaluation-1" class="nav-link" data-scroll-target="#model-evaluation-1"><span class="toc-section-number">4.11.5</span>  Model Evaluation</a></li>
  <li><a href="#final-model" id="toc-final-model" class="nav-link" data-scroll-target="#final-model"><span class="toc-section-number">4.11.6</span>  Final Model</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1"><span class="toc-section-number">4.11.7</span>  Summary</a></li>
  <li><a href="#model-convergence-1" id="toc-model-convergence-1" class="nav-link" data-scroll-target="#model-convergence-1"><span class="toc-section-number">4.11.8</span>  Model Convergence</a></li>
  <li><a href="#visual-interpretation-of-the-model-bonus-points" id="toc-visual-interpretation-of-the-model-bonus-points" class="nav-link" data-scroll-target="#visual-interpretation-of-the-model-bonus-points"><span class="toc-section-number">4.11.9</span>  Visual Interpretation of the Model (Bonus Points!)</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/StanPMx/stanpmx.github.io/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Logistic Regression Using <code>brms</code></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="load-relevant-libraries" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="load-relevant-libraries"><span class="header-section-number">4.1</span> Load Relevant Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes) </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="logistic-regression" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">4.2</span> Logistic Regression</h2>
<p>The goal of logistic regression is to find the best fitting model to describe the relationship between the dichotomous characteristic of interest (response or outcome) and a set of independent (predictor or explanatory) variables.</p>
<p>Data for this exercise <strong>heart_cleveland_upload.csv</strong> was obtained here (<a href="https://www.kaggle.com/datasets/cherngs/heart-disease-cleveland-uci" class="uri">https://www.kaggle.com/datasets/cherngs/heart-disease-cleveland-uci</a>). It is a multivariate dataset composed of 14 columns shown below:</p>
<ol type="1">
<li>age: age in years</li>
<li>sex: sex [1 = male; 0 = female]</li>
<li>cp: chest pain type [0 = typical angina; 1 = atypical angina; 2 = non-anginal pain; 3 = asymptomatic]</li>
<li>trestbps: resting blood pressure in mm Hg on admission to the hospital</li>
<li>chol: serum cholestoral in mg/dl</li>
<li>fbs: fasting blood sugar &gt; 120 mg/dl [1 = true; 0 = false]</li>
<li>restecg: resting electrocardiographic results [0 = normal; 1 = having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of &gt; 0.05 mV); 2 = showing probable or definite left ventricular hypertrophy by Estes’ criteria]</li>
<li>thalach: maximum heart rate achieved</li>
<li>exang: exercise induced angina [1 = yes; 0 = no]</li>
<li>oldpeak = ST depression induced by exercise relative to rest</li>
<li>slope: the slope of the peak exercise ST segment [0 = upsloping; 1 = flat; 2 = downsloping]</li>
<li>ca: number of major vessels (0-3) colored by flourosopy</li>
<li>thal: thallium stress test result [0 = normal; 1 = fixed defect; 2 = reversible defect]</li>
<li>condition: 0 = no disease, 1 = disease</li>
</ol>
</section>
<section id="import-data" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="import-data"><span class="header-section-number">4.3</span> Import Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lrDataRaw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/heart_cleveland_upload.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-processing" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="data-processing"><span class="header-section-number">4.4</span> Data Processing</h2>
<p>Convert categorical explanatory variables to factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lrData <span class="ot">&lt;-</span> lrDataRaw <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">factor</span>(sex, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">cp =</span> <span class="fu">factor</span>(cp, <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"typical angina"</span>, <span class="st">"atypical angina"</span>, <span class="st">"non-anginal pain"</span>, <span class="st">"asymptomatic"</span>)),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">fbs =</span> <span class="fu">factor</span>(fbs, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"false"</span>, <span class="st">"true"</span>)),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">restecg =</span> <span class="fu">factor</span>(restecg, <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"normal"</span>, <span class="st">"abnormal ST"</span>, <span class="st">"LV hypertrophy"</span>)),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">exang =</span> <span class="fu">factor</span>(exang, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"yes"</span>)),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">slope =</span> <span class="fu">factor</span>(slope, <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"upsloping"</span>, <span class="st">"flat"</span>, <span class="st">"downsloping"</span>)),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">thal =</span> <span class="fu">factor</span>(thal, <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"normal"</span>, <span class="st">"fixed defect"</span>, <span class="st">"reversable defect"</span>)))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>lrData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 297 x 14
     age sex    cp       trest~1  chol fbs   restecg thalach exang oldpeak slope
   &lt;int&gt; &lt;fct&gt;  &lt;fct&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;fct&gt;
 1    69 male   typical~     160   234 true  LV hyp~     131 no        0.1 flat 
 2    69 female typical~     140   239 false normal      151 no        1.8 upsl~
 3    66 female typical~     150   226 false normal      114 no        2.6 down~
 4    65 male   typical~     138   282 true  LV hyp~     174 no        1.4 flat 
 5    64 male   typical~     110   211 false LV hyp~     144 yes       1.8 flat 
 6    64 male   typical~     170   227 false LV hyp~     155 no        0.6 flat 
 7    63 male   typical~     145   233 true  LV hyp~     150 no        2.3 down~
 8    61 male   typical~     134   234 false normal      145 no        2.6 flat 
 9    60 female typical~     150   240 false normal      171 no        0.9 upsl~
10    59 male   typical~     178   270 false LV hyp~     145 no        4.2 down~
# ... with 287 more rows, 3 more variables: ca &lt;int&gt;, thal &lt;fct&gt;,
#   condition &lt;int&gt;, and abbreviated variable name 1: trestbps</code></pre>
</div>
</div>
</section>
<section id="data-summary" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="data-summary"><span class="header-section-number">4.5</span> Data Summary</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summarytools<span class="sc">::</span><span class="fu">dfSummary</span>(lrData,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">varnumbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">valid.col =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">graph.magnif =</span> <span class="fl">0.76</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"render"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="container st-container">
<h3 class="anchored">Data Frame Summary</h3>
<strong>
lrData
<br>
</strong>
<strong>Dimensions</strong>: 297 x 14
  <br><strong>Duplicates</strong>: 0
<br>
<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline ">
  <thead>
    <tr>
      <th align="center" class="st-protect-top-border"><strong>Variable</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Stats / Values</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Freqs (% of Valid)</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Graph</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Missing</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="left">age
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 54.5 (9)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min ≤ med ≤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">29 ≤ 56 ≤ 77</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 13 (0.2)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">41 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAHYAAABVBAMAAABusQ26AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkE8td2mgAAAI5JREFUWMPt2FEKgCAMBmCvkDdIb1D3v1ttlCaIuFVQ7v8ffLB9KARTdM5epkZ8oFQ+9Nh1zwILCwvbZ7ndKG0kBvsTSz96Vloa3rY+bVBhUyEs7CCWW7PSxnOwa0PZ8EQ2lovDwsJ+y/p0c1XYsnBomy/4clspfNjm1w655ak7lhc/bOWwbVqeulppnL1s9f3N4jdeySEAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMTEtMTFUMTc6NDE6MDQrMDA6MDDyr5U/AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTExLTExVDE3OjQxOjA0KzAwOjAwg/ItgwAAAABJRU5ErkJggg=="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">sex
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. female</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. male</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">96</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">32.3%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">201</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">67.7%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAFoAAAAqBAMAAADBpFHwAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkE8td2mgAAADtJREFUOMtjYBi6QAkDKApiAVDVysboYFT1qGr6qiYtxQoSB8hSrUQcwOlLbMBoVPWoapqpJi3FDkUAAE9byM95L4r0AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTExLTExVDE3OjQxOjA0KzAwOjAw8q+VPwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0xMS0xMVQxNzo0MTowNCswMDowMIPyLYMAAAAASUVORK5CYII="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">cp
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. typical angina</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. atypical angina</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">3. non-anginal pain</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">4. asymptomatic</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">23</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">7.7%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">49</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">16.5%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">83</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">27.9%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">142</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">47.8%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEMAAABPBAMAAABCJmU7AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkE8td2mgAAAF5JREFUSMdjYBhcQAkEBLECAagSZWNjY6NRJSNACRGJQRA3IEGJEhzgdS4YGI0qGd5KiEgMgrgBrRImhoswfITpr1Elw0oJEYmBNqkOCShgdy4yGFUyrJQQkRgGCwAA2lP0oKHtcCMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMTEtMTFUMTc6NDE6MDQrMDA6MDDyr5U/AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTExLTExVDE3OjQxOjA0KzAwOjAwg/ItgwAAAABJRU5ErkJggg=="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">trestbps
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 131.7 (17.8)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min ≤ med ≤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">94 ≤ 130 ≤ 200</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 20 (0.1)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">50 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAHYAAABVBAMAAABusQ26AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkE8td2mgAAAIZJREFUWMPt18ENgCAMBVBWqBsIG9j9dxOrEEUQbTwo/H9s+lJCIARj+gsdMlifkWrJW/aBbdva6gEpW1cd3oKVK2SVdhETLCwsLCwsUXxOFNYF9o6VpSitlGBhv2ZLh/qO5cJwWNhubfJF3KxUL21o4JNNGjM2lv5q11+j0kppv89PY/rLDHYBz3fkEJ5fAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTExLTExVDE3OjQxOjA0KzAwOjAw8q+VPwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0xMS0xMVQxNzo0MTowNCswMDowMIPyLYMAAAAASUVORK5CYII="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">chol
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 247.4 (52)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min ≤ med ≤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">126 ≤ 243 ≤ 564</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 65 (0.2)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">152 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAHYAAABVBAMAAABusQ26AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkE8td2mgAAAHNJREFUWMPt2MENgCAMQFFWwA0oG8j+uymYAMFEpNFT/z94MLzYU01wzl6+tknOv+lu09mOxWKx2P9sWdJBZ/MjYbFYLPY7W5ay6GyszKad/dCebJx8HIvFYpW2rCaljfXsaKUVVm172Y1wXdz0M6/m7HUAXyqPwEQN1mQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMTEtMTFUMTc6NDE6MDQrMDA6MDDyr5U/AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTExLTExVDE3OjQxOjA0KzAwOjAwg/ItgwAAAABJRU5ErkJggg=="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">fbs
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. false</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. true</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">254</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">85.5%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">43</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">14.5%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAG4AAAAqBAMAAACgvHOyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkE8td2mgAAADhJREFUSMdjYBj+QIlUANWnbEwaMBrVN6pvGOsjNx8Jkgoo1AezXpFEfbBwGdU3qm9UH/n5aDgDAGHm32OtyBZdAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTExLTExVDE3OjQxOjA0KzAwOjAw8q+VPwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0xMS0xMVQxNzo0MTowNCswMDowMIPyLYMAAAAASUVORK5CYII="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">restecg
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. normal</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. abnormal ST</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">3. LV hypertrophy</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">147</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">49.5%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">4</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">1.3%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">146</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">49.2%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEUAAAA8BAMAAADCjmoTAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkE8td2mgAAADtJREFUSMdjYBh8QAkPUICqUTbGDUbVDF81xKQNQTxAgAQ1SqNqRtVQoEaQSmpGy8NRNbjUEJM2BhMAAB+O1NGy4Q4sAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTExLTExVDE3OjQxOjA0KzAwOjAw8q+VPwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0xMS0xMVQxNzo0MTowNCswMDowMIPyLYMAAAAASUVORK5CYII="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">thalach
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 149.6 (22.9)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min ≤ med ≤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">71 ≤ 153 ≤ 202</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 33 (0.2)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">91 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAHYAAABVBAMAAABusQ26AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkFhdBGDAAAAJxJREFUWMPt2G0KgCAMBmCvUDeobtDuf7ccKU6FcuuDyPcF/8ge9MdwlHP9ZTjM7DPV2012ISL2VuvXCvs/yz1htcHBwj5mizdLZSk/GxYWtsGOaSbobXKvWb7vbLW0F8PC3mZDP5psLIS9ZMWnktr6BSt72WqLQtgHrBjWelsXfsjG3x3JFoP+wC7hbGHz4nZbP+YnloGw6rj+sgEI7tiYtJW9XQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0xMS0xMVQxNzo0MTowNSswMDowMFTYnosAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMTEtMTFUMTc6NDE6MDUrMDA6MDAlhSY3AAAAAElFTkSuQmCC"></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">exang
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. no</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. yes</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">200</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">67.3%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">97</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">32.7%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAFkAAAAqBAMAAAAqk+rzAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkFhdBGDAAAADlJREFUOMtjYBi6QIkooABVrWxMDBhVPaqadqpJS7GCRAEBslRjsRaPakxfGo2qHlVNV9WkpdihCADKdcitmx/FrAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0xMS0xMVQxNzo0MTowNSswMDowMFTYnosAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMTEtMTFUMTc6NDE6MDUrMDA6MDAlhSY3AAAAAElFTkSuQmCC"></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">oldpeak
[numeric]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 1.1 (1.2)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min ≤ med ≤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">0 ≤ 0.8 ≤ 6.2</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 1.6 (1.1)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">40 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAHYAAABVBAMAAABusQ26AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkFhdBGDAAAAIFJREFUWMPt1sEJwCAMBVBXaDdouoHZf7ea4kFK0CSFYvF/EE+Pb8SDKa0XKjk2Z6o9mRkWFhYWFhYWFhYW9hvr/rs31t09iXXN/LCubsWauxVr7ob9tR2+kY4d9k9mZdaoNd23we5yiIAVRmXPASsrv7Xaua226b7nl1RLkaT1cgGZc2fjivjQ9wAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0xMS0xMVQxNzo0MTowNSswMDowMFTYnosAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMTEtMTFUMTc6NDE6MDUrMDA6MDAlhSY3AAAAAElFTkSuQmCC"></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">slope
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. upsloping</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. flat</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">3. downsloping</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">139</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">46.8%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">137</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">46.1%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">21</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">7.1%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEIAAAA8BAMAAAAgUnFqAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkFhdBGDAAAAEJJREFUOMtjYBg8QAk3gKpQNsYFjEZVDHEVhGNfEDcgWgVuSxQJunRUxVBXQTj2qZXGFPGqALl0VMXwVEE49gcDAADKmM4dlQUjrAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0xMS0xMVQxNzo0MTowNSswMDowMFTYnosAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMTEtMTFUMTc6NDE6MDUrMDA6MDAlhSY3AAAAAElFTkSuQmCC"></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">ca
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 0.7 (0.9)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min ≤ med ≤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">0 ≤ 0 ≤ 3</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 1 (1.4)</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">0</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">174</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">58.6%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">1</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">65</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">21.9%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">2</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">38</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">12.8%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">3</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">20</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">6.7%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAE8AAABPBAMAAABYGoW1AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkFhdBGDAAAAGNJREFUSMft08EJwCAQRNEtIduBiR1o/7152UNy2MwoCAnMPz9QYTT7RxeqBKwdJCiYQnpmjjpm4eOYN3h/TBMUnIL0zBy1D8btTgjj1YKCC5CemaOWFk7BmnxnQUEM6Zl9vQHiiBAJRD+CjgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0xMS0xMVQxNzo0MTowNSswMDowMFTYnosAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMTEtMTFUMTc6NDE6MDUrMDA6MDAlhSY3AAAAAElFTkSuQmCC"></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">thal
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. normal</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. fixed defect</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">3. reversable defect</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">164</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">55.2%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">18</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">6.1%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">115</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">38.7%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEsAAAA8BAMAAADcR1qgAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkFhdBGDAAAAEpJREFUSMdjYBjcQAk/UIAqUzbGC0aVjXhlRCYkQfxAgDRlIJOJUAb0gtGoslFluJURmZAE8QMyUi8mUMTiBSxgVNmoMhIT0mAFAJbu3y3Gw05jAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTExLTExVDE3OjQxOjA1KzAwOjAwVNieiwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0xMS0xMVQxNzo0MTowNSswMDowMCWFJjcAAAAASUVORK5CYII="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">condition
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Min  : 0</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean : 0.5</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Max  : 1</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">0</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">160</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">53.9%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 2px 0 7px;margin:0;border:0" align="right">1</td><td style="padding:0 2px;border:0;" align="left">:</td><td style="padding:0 4px 0 6px;margin:0;border:0" align="right">137</td><td style="padding:0;border:0" align="left">(</td><td style="padding:0 2px;margin:0;border:0" align="right">46.1%</td><td style="padding:0 4px 0 0;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEoAAAAqBAMAAADmCtAYAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH5gsLESkFhdBGDAAAADRJREFUOMtjYBi8QAk/gKpSNsYHjEZVjUBVxKUcQfyAJFW4LVNEUoXb9aOqRqoq4lLOYAQAD5q2v/IqucwAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMTEtMTFUMTc6NDE6MDUrMDA6MDBU2J6LAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTExLTExVDE3OjQxOjA1KzAwOjAwJYUmNwAAAABJRU5ErkJggg=="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="data-exploration" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="data-exploration"><span class="header-section-number">4.6</span> Data Exploration</h2>
<p>First lets explore some relationships between categorical explanatory variables and outcome variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>lrData <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sex, cp, fbs, restecg, exang, slope, thal, condition) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(sex, cp, fbs, restecg, exang, slope, thal),   </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, value) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">condition =</span> <span class="fu">sum</span>(condition))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 x 3
# Groups:   name [7]
   name    value             condition
   &lt;chr&gt;   &lt;fct&gt;                 &lt;int&gt;
 1 cp      typical angina            7
 2 cp      atypical angina           9
 3 cp      non-anginal pain         18
 4 cp      asymptomatic            103
 5 exang   no                       63
 6 exang   yes                      74
 7 fbs     false                   117
 8 fbs     true                     20
 9 restecg normal                   55
10 restecg abnormal ST               3
11 restecg LV hypertrophy           79
12 sex     female                   25
13 sex     male                    112
14 slope   upsloping                36
15 slope   flat                     89
16 slope   downsloping              12
17 thal    normal                   37
18 thal    fixed defect             12
19 thal    reversable defect        88</code></pre>
</div>
</div>
</section>
<section id="model-fit" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="model-fit"><span class="header-section-number">4.7</span> Model Fit</h2>
<p>We will start with a Bayesian binary logistic regression with non-informative priors.</p>
<p><code>brm</code> function is used to fit Bayesian generalized (non-)linear multivariate multilevel models using Stan for full Bayesian inference.</p>
<p>The <code>brm</code> has three basic arguments: <code>formula</code>, <code>data</code>, and <code>family</code>. <code>warmup</code> specifies the burn-in period (i.e.&nbsp;number of iterations that should be discarded); <code>iter</code> specifies the total number of iterations (including the burn-in iterations); <code>chains</code> specifies the number of chains; inits specifies the starting values of the iterations (normally you can either use the maximum likelihood esimates of the parameters as starting values, or simply ask the algorithm to start with zeros); cores specifies the number of cores used for the algorithm; seed specifies the random seed, allowing for replication of results.</p>
<div class="cell" data-hash="logisticregression_cache/html/unnamed-chunk-6_681c849f05934661db1566498026fed8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lrfit1 <span class="ot">&lt;-</span>  <span class="fu">brm</span>(condition <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> cp <span class="sc">+</span> trestbps <span class="sc">+</span> chol <span class="sc">+</span> fbs <span class="sc">+</span> restecg <span class="sc">+</span> thalach <span class="sc">+</span> exang <span class="sc">+</span> oldpeak <span class="sc">+</span> slope <span class="sc">+</span> ca <span class="sc">+</span> thal,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> lrData,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="fu">bernoulli</span>(),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">seed =</span> <span class="dv">12345</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">backend =</span> <span class="st">"cmdstanr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-evaluation" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="model-evaluation"><span class="header-section-number">4.8</span> Model Evaluation</h2>
<section id="summary" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">4.8.1</span> Summary</h3>
<p>Below is the summary of the logistic regression model fit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lrfit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: condition ~ age + sex + cp + trestbps + chol + fbs + restecg + thalach + exang + oldpeak + slope + ca + thal 
   Data: lrData (Number of observations: 297) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept               -6.78      3.04   -12.81    -0.89 1.00     4434
age                     -0.02      0.03    -0.07     0.03 1.00     4079
sexmale                  1.73      0.55     0.68     2.84 1.00     3858
cpatypicalangina         1.46      0.82    -0.16     3.07 1.00     3348
cpnonManginalpain        0.30      0.70    -1.06     1.67 1.00     3631
cpasymptomatic           2.41      0.70     1.07     3.80 1.00     2878
trestbps                 0.03      0.01     0.01     0.05 1.00     5297
chol                     0.01      0.00    -0.00     0.01 1.00     5351
fbstrue                 -0.65      0.65    -1.95     0.60 1.00     4801
restecgabnormalST        1.20      2.22    -2.74     5.66 1.00     4867
restecgLVhypertrophy     0.54      0.41    -0.25     1.34 1.00     3893
thalach                 -0.02      0.01    -0.04     0.00 1.00     4119
exangyes                 0.78      0.46    -0.12     1.68 1.00     4387
oldpeak                  0.43      0.25    -0.04     0.92 1.00     4092
slopeflat                1.25      0.52     0.23     2.30 1.00     3410
slopedownsloping         0.47      0.99    -1.56     2.31 1.00     3793
ca                       1.47      0.30     0.92     2.10 1.00     4288
thalfixeddefect         -0.01      0.84    -1.70     1.61 1.00     4322
thalreversabledefect     1.55      0.45     0.69     2.44 1.00     4912
                     Tail_ESS
Intercept                3102
age                      3412
sexmale                  3303
cpatypicalangina         3069
cpnonManginalpain        3379
cpasymptomatic           3052
trestbps                 2891
chol                     3134
fbstrue                  3118
restecgabnormalST        2843
restecgLVhypertrophy     3196
thalach                  2805
exangyes                 2849
oldpeak                  2933
slopeflat                2601
slopedownsloping         2841
ca                       3626
thalfixeddefect          2726
thalreversabledefect     3112

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Looking at the 95% credible intervals for some of the estimates, they are very wide and include zero suggesting very uncertain estimates. Based on this finding, let’s update the model and keep only sex, cp, trestbps, slope, ca, and thal as covariates.</p>
<div class="cell" data-hash="logisticregression_cache/html/unnamed-chunk-8_604977e94e6c9fbc246dae92e0d8b88a">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>lrfit2 <span class="ot">&lt;-</span>  <span class="fu">brm</span>(condition <span class="sc">~</span> sex <span class="sc">+</span> cp <span class="sc">+</span> trestbps <span class="sc">+</span> slope <span class="sc">+</span> ca <span class="sc">+</span> thal,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> lrData,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="fu">bernoulli</span>(),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">seed =</span> <span class="dv">12345</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">backend =</span> <span class="st">"cmdstanr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below is the summary of the updated logistic regression fit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lrfit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: condition ~ sex + cp + trestbps + slope + ca + thal 
   Data: lrData (Number of observations: 297) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept               -8.77      1.88   -12.49    -5.08 1.00     2629
sexmale                  1.51      0.50     0.58     2.51 1.00     3479
cpatypicalangina         1.08      0.79    -0.47     2.67 1.00     2046
cpnonManginalpain        0.22      0.69    -1.12     1.59 1.00     1989
cpasymptomatic           2.64      0.68     1.35     4.01 1.00     1955
trestbps                 0.03      0.01     0.01     0.05 1.00     4664
slopeflat                1.95      0.44     1.10     2.83 1.00     3344
slopedownsloping         1.43      0.73     0.04     2.89 1.00     3519
ca                       1.41      0.26     0.93     1.93 1.00     3633
thalfixeddefect          0.09      0.75    -1.39     1.54 1.00     3626
thalreversabledefect     1.64      0.42     0.83     2.48 1.00     4102
                     Tail_ESS
Intercept                2749
sexmale                  3054
cpatypicalangina         2519
cpnonManginalpain        2670
cpasymptomatic           2641
trestbps                 2928
slopeflat                3188
slopedownsloping         3028
ca                       2956
thalfixeddefect          3112
thalreversabledefect     2862

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="model-convergence" class="level3" data-number="4.8.2">
<h3 data-number="4.8.2" class="anchored" data-anchor-id="model-convergence"><span class="header-section-number">4.8.2</span> Model Convergence</h3>
<p>The posterior distributions of the parameters: density and trace plots of the MCMC chains:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lrfit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="logisticregression_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="logisticregression_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="logisticregression_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The chains seem to be well mixed for all the parameters.</p>
<p><code>bayesplot</code> package gives us a bit more control on the plotting features.</p>
<p><strong>Trace Plots:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(lrfit2, <span class="at">add_chain =</span> T)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "b_Intercept"            "b_sexmale"              "b_cpatypicalangina"    
 [4] "b_cpnonManginalpain"    "b_cpasymptomatic"       "b_trestbps"            
 [7] "b_slopeflat"            "b_slopedownsloping"     "b_ca"                  
[10] "b_thalfixeddefect"      "b_thalreversabledefect" "lprior"                
[13] "lp__"                   ".chain"                 ".iteration"            
[16] ".draw"                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example with a few select parameters</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(post[,<span class="fu">c</span>(<span class="st">"b_sexmale"</span>, <span class="st">"b_trestbps"</span>, <span class="st">"b_ca"</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">".chain"</span>, <span class="st">".iteration"</span>, <span class="st">".draw"</span>)],</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">facet_args =</span> <span class="fu">list</span>(<span class="at">ncol =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="logisticregression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Autocorrelation Plots:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_acf</span>(post, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"b_sexmale"</span>, <span class="st">"b_trestbps"</span>, <span class="st">"b_ca"</span>)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="logisticregression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="frequentist-approach" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="frequentist-approach"><span class="header-section-number">4.9</span> Frequentist Approach</h2>
<p>Just for fun, let’s compare the estimation process using a frequentist approach using <code>glm</code>.</p>
<div class="cell" data-hash="logisticregression_cache/html/unnamed-chunk-13_3146a5f0da33e7c22ff631a466207eff">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lrfit3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> condition <span class="sc">~</span> sex <span class="sc">+</span> cp<span class="sc">+</span> trestbps <span class="sc">+</span> slope <span class="sc">+</span> ca <span class="sc">+</span> thal, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> lrData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lrfit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = condition ~ sex + cp + trestbps + slope + ca + 
    thal, family = "binomial", data = lrData)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8277  -0.4972  -0.1416   0.4734   2.8011  

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           -8.18943    1.77935  -4.602 4.17e-06 ***
sexmale                1.42390    0.47448   3.001 0.002691 ** 
cpatypical angina      1.00877    0.75051   1.344 0.178911    
cpnon-anginal pain     0.20579    0.66020   0.312 0.755265    
cpasymptomatic         2.47223    0.64521   3.832 0.000127 ***
trestbps               0.02460    0.01013   2.427 0.015205 *  
slopeflat              1.83180    0.41358   4.429 9.46e-06 ***
slopedownsloping       1.36450    0.70070   1.947 0.051494 .  
ca                     1.32207    0.24861   5.318 1.05e-07 ***
thalfixed defect       0.06788    0.71713   0.095 0.924585    
thalreversable defect  1.54348    0.40110   3.848 0.000119 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 205.97  on 286  degrees of freedom
AIC: 227.97

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Comparing the model estimates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(lrfit3)<span class="sc">$</span>coefficients[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">fixef</span>(lrfit2)[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(<span class="fu">tableGrob</span>(<span class="fu">round</span>(t1, <span class="dv">4</span>), <span class="at">rows =</span> <span class="cn">NULL</span>), <span class="at">top =</span> <span class="st">"Frequentist"</span>), </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">arrangeGrob</span>(<span class="fu">tableGrob</span>(<span class="fu">round</span>(t2, <span class="dv">4</span>), <span class="at">rows =</span> <span class="cn">NULL</span>), <span class="at">top =</span> <span class="st">"Bayesian"</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="logisticregression_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the estimates above, the Bayesian model estimates are very close to those of the frequentist model. The interpretation of these estimates is the same between these approaches. However, the interpretation of the uncertainty intervals is not the same between the two models.</p>
<p>With the frequentist model, the 95% uncertainty interval also called the confidence interval suggests that under repeated sampling, 95% of the resulting uncertainty intervals would cover the true population value. This is different from saying that there is a 95% chance that the confidence interval contains the true population value (not probability statements).</p>
<p>With the Bayesian model, the 95% uncertainty interval also called the credibility interval is more interpretable and states that there is 95% chance that the true population value falls within this interval. When the 95% credibility intervals do not contain zero, we conclude that the respective model parameters are less uncertain and likely more meaningful.</p>
</section>
<section id="priors" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="priors"><span class="header-section-number">4.10</span> Priors</h2>
<p>Prior specifications are useful in Bayesian modeling as they provide a means to include existing information on parameters of interest. As an example, if we are interested in learning about new population (e.g.&nbsp;pediatrics) and have the adult information on estimated parameters, including prior distributions based on adult parameters give us flexibility to explicitly apply our understanding on the estimation of such parameters for the pediatric population.</p>
<p>To see a list of all the priors that can be specified, we can use <code>get_prior</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(condition <span class="sc">~</span> sex <span class="sc">+</span> cp <span class="sc">+</span> trestbps <span class="sc">+</span> slope <span class="sc">+</span> ca <span class="sc">+</span> thal,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> lrData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class                 coef group resp dpar nlpar lb
               (flat)         b                                              
               (flat)         b                   ca                         
               (flat)         b       cpasymptomatic                         
               (flat)         b     cpatypicalangina                         
               (flat)         b    cpnonManginalpain                         
               (flat)         b              sexmale                         
               (flat)         b     slopedownsloping                         
               (flat)         b            slopeflat                         
               (flat)         b      thalfixeddefect                         
               (flat)         b thalreversabledefect                         
               (flat)         b             trestbps                         
 student_t(3, 0, 2.5) Intercept                                              
 student_t(3, 0, 2.5)     sigma                                             0
 ub       source
         default
    (vectorized)
    (vectorized)
    (vectorized)
    (vectorized)
    (vectorized)
    (vectorized)
    (vectorized)
    (vectorized)
    (vectorized)
    (vectorized)
         default
         default</code></pre>
</div>
</div>
<section id="set-up-priors" class="level3" data-number="4.10.1">
<h3 data-number="4.10.1" class="anchored" data-anchor-id="set-up-priors"><span class="header-section-number">4.10.1</span> Set Up Priors</h3>
<p>Let’s set some priors and let’s assume we know precisely one of the priors <code>thalfixeddefect</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>prior1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(5, 100)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"sexmale"</span>),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">set_prior</span>(<span class="st">"normal(0.1, 0.03)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"thalfixeddefect"</span>),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">set_prior</span>(<span class="st">"normal(5, 100)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"thalreversabledefect"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fit-with-priors" class="level3" data-number="4.10.2">
<h3 data-number="4.10.2" class="anchored" data-anchor-id="model-fit-with-priors"><span class="header-section-number">4.10.2</span> Model Fit with Priors</h3>
<p>We can incorporate the priors into the model as follows:</p>
<div class="cell" data-hash="logisticregression_cache/html/unnamed-chunk-18_21c717b4650b8e7ad37b0fef511f9792">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lrfit4 <span class="ot">&lt;-</span>  <span class="fu">brm</span>(condition <span class="sc">~</span> sex <span class="sc">+</span> cp <span class="sc">+</span> trestbps <span class="sc">+</span> slope <span class="sc">+</span> ca <span class="sc">+</span> thal,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> lrData,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="fu">bernoulli</span>(),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">prior =</span> prior1,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">seed =</span> <span class="dv">12345</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">refresh =</span> <span class="dv">0</span>, </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">sample_prior =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To see how the priors have been updated in the model, we use <code>prior_summary</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(lrfit4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class                 coef group resp dpar nlpar lb
               (flat)         b                                              
               (flat)         b                   ca                         
               (flat)         b       cpasymptomatic                         
               (flat)         b     cpatypicalangina                         
               (flat)         b    cpnonManginalpain                         
       normal(5, 100)         b              sexmale                         
               (flat)         b     slopedownsloping                         
               (flat)         b            slopeflat                         
    normal(0.1, 0.03)         b      thalfixeddefect                         
       normal(5, 100)         b thalreversabledefect                         
               (flat)         b             trestbps                         
 student_t(3, 0, 2.5) Intercept                                              
 ub       source
         default
    (vectorized)
    (vectorized)
    (vectorized)
    (vectorized)
            user
    (vectorized)
    (vectorized)
            user
            user
    (vectorized)
         default</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lrfit4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: condition ~ sex + cp + trestbps + slope + ca + thal 
   Data: lrData (Number of observations: 297) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept               -8.78      1.84   -12.53    -5.28 1.00     2760
sexmale                  1.51      0.47     0.61     2.44 1.00     3450
cpatypicalangina         1.12      0.77    -0.36     2.67 1.00     2617
cpnonManginalpain        0.26      0.69    -1.08     1.61 1.00     2529
cpasymptomatic           2.66      0.67     1.40     4.02 1.00     2378
trestbps                 0.03      0.01     0.01     0.05 1.00     4305
slopeflat                1.95      0.41     1.16     2.77 1.00     3480
slopedownsloping         1.45      0.72     0.08     2.86 1.00     4050
ca                       1.41      0.26     0.93     1.97 1.00     3831
thalfixeddefect          0.10      0.03     0.04     0.16 1.00     4923
thalreversabledefect     1.64      0.40     0.84     2.43 1.00     4412
                     Tail_ESS
Intercept                2667
sexmale                  3235
cpatypicalangina         2902
cpnonManginalpain        2960
cpasymptomatic           2460
trestbps                 2811
slopeflat                2927
slopedownsloping         2639
ca                       2790
thalfixeddefect          2850
thalreversabledefect     2905

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="compare-prior-and-posterior-samples" class="level3" data-number="4.10.3">
<h3 data-number="4.10.3" class="anchored" data-anchor-id="compare-prior-and-posterior-samples"><span class="header-section-number">4.10.3</span> Compare Prior and Posterior Samples</h3>
<p>Let’s compare the prior and posterior distributions for a non-informative prior <code>sexmale</code> and a highly informative prior <code>thalfixeddefect</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>priorSamples <span class="ot">&lt;-</span> <span class="fu">prior_draws</span>(lrfit4, <span class="fu">c</span>(<span class="st">"b_sexmale"</span>, <span class="st">"b_thalfixeddefect"</span>)) </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>posteriorSamples <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(lrfit4, <span class="fu">c</span>(<span class="st">"b_sexmale"</span>, <span class="st">"b_thalfixeddefect"</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> priorSamples, <span class="fu">aes</span>(<span class="at">x =</span> b_sexmale, <span class="at">fill =</span> <span class="st">"prior"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> posteriorSamples, <span class="fu">aes</span>(<span class="at">x =</span> b_sexmale, <span class="at">fill =</span> <span class="st">"posterior"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"prior"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"posterior"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>)) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span> (<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> priorSamples, <span class="fu">aes</span>(<span class="at">x =</span> b_thalfixeddefect, <span class="at">fill =</span> <span class="st">"prior"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> posteriorSamples, <span class="fu">aes</span>(<span class="at">x =</span> b_thalfixeddefect, <span class="at">fill =</span> <span class="st">"posterior"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"prior"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"posterior"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>)) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.3</span>)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3696 rows containing non-finite values (stat_density).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="logisticregression_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="hands-on-example" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="hands-on-example"><span class="header-section-number">4.11</span> Hands-On Example</h2>
<p>A simulated dataset for this exercise <strong>simlrcovs.csv</strong> was developed. It has the following columns:</p>
<ol type="1">
<li>DOSE: Dose of drug in mg [20, 50, 100, 200 mg]</li>
<li>CAVG: Average concentration until the time of the event (mg/L)</li>
<li>ECOG: ECOG performance status [0 = Fully active; 1 = Restricted in physical activity]</li>
<li>RACE: Race [1 = Others; 2 = White]</li>
<li>SEX: Sex [1 = Female; 2 = Male]</li>
<li>BRNMETS: Brain metastasis [1 = Yes; 0 = No]</li>
<li>DV: Event [1 = Yes; 0 = No]</li>
</ol>
<section id="import-dataset" class="level3" data-number="4.11.1">
<h3 data-number="4.11.1" class="anchored" data-anchor-id="import-dataset"><span class="header-section-number">4.11.1</span> Import Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the dataset</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>hoRaw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/simlrcovs.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-processing-1" class="level3" data-number="4.11.2">
<h3 data-number="4.11.2" class="anchored" data-anchor-id="data-processing-1"><span class="header-section-number">4.11.2</span> Data Processing</h3>
<p>Convert categorical explanatory variables to factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>hoData <span class="ot">&lt;-</span> hoRaw <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ECOG =</span> <span class="fu">factor</span>(ECOG, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Active"</span>, <span class="st">"Restricted"</span>)),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">RACE =</span> <span class="fu">factor</span>(RACE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Others"</span>)),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">SEX =</span> <span class="fu">factor</span>(SEX, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>)),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">BRNMETS =</span> <span class="fu">factor</span>(BRNMETS, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>hoData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 x 7
    DOSE  CAVG ECOG       RACE   SEX    BRNMETS    DV
   &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;      &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;   &lt;int&gt;
 1    20  203. Active     White  Female Yes         0
 2    20  202. Restricted White  Female No          0
 3    20  287. Restricted Others Female No          0
 4    20  174. Restricted Others Male   Yes         0
 5    20  270. Active     Others Male   Yes         0
 6    20  265. Active     Others Female No          1
 7    20  206. Restricted Others Female No          0
 8    20  253. Active     Others Male   No          1
 9    20  186. Active     White  Male   No          0
10    20  186. Restricted Others Female No          1
# ... with 190 more rows</code></pre>
</div>
</div>
</section>
<section id="data-summary-1" class="level3" data-number="4.11.3">
<h3 data-number="4.11.3" class="anchored" data-anchor-id="data-summary-1"><span class="header-section-number">4.11.3</span> Data Summary</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>  xxxxxx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fit-1" class="level3" data-number="4.11.4">
<h3 data-number="4.11.4" class="anchored" data-anchor-id="model-fit-1"><span class="header-section-number">4.11.4</span> Model Fit</h3>
<p>With all covariates except DOSE (since we have exposure as a driver)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>hofit1 <span class="ot">&lt;-</span>  <span class="fu">brm</span>(xxxxxx <span class="sc">~</span> xxxxxx,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> xxxxxx,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> xxxxxx,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">seed =</span> <span class="dv">12345</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">backend =</span> <span class="st">"cmdstanr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-evaluation-1" class="level3" data-number="4.11.5">
<h3 data-number="4.11.5" class="anchored" data-anchor-id="model-evaluation-1"><span class="header-section-number">4.11.5</span> Model Evaluation</h3>
<p>Get the summary of the model and look at the fixed efects</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>xxxxxx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-model" class="level3" data-number="4.11.6">
<h3 data-number="4.11.6" class="anchored" data-anchor-id="final-model"><span class="header-section-number">4.11.6</span> Final Model</h3>
<p>Refit the model with meaningful covariates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>hofit2 <span class="ot">&lt;-</span>  <span class="fu">brm</span>(xxxxxx <span class="sc">~</span> xxxxxx,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> xxxxxx,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> xxxxxx,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">seed =</span> <span class="dv">12345</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">backend =</span> <span class="st">"cmdstanr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-1" class="level3" data-number="4.11.7">
<h3 data-number="4.11.7" class="anchored" data-anchor-id="summary-1"><span class="header-section-number">4.11.7</span> Summary</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>xxxxxx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-convergence-1" class="level3" data-number="4.11.8">
<h3 data-number="4.11.8" class="anchored" data-anchor-id="model-convergence-1"><span class="header-section-number">4.11.8</span> Model Convergence</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>hopost <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(xxxxxx, <span class="at">add_chain =</span> T)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(xxxxxx) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_acf</span>(xxxxxx) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visual-interpretation-of-the-model-bonus-points" class="level3" data-number="4.11.9">
<h3 data-number="4.11.9" class="anchored" data-anchor-id="visual-interpretation-of-the-model-bonus-points"><span class="header-section-number">4.11.9</span> Visual Interpretation of the Model (Bonus Points!)</h3>
<p>We can do this two ways.</p>
<section id="generate-posterior-probabilities-manually" class="level4" data-number="4.11.9.1">
<h4 data-number="4.11.9.1" class="anchored" data-anchor-id="generate-posterior-probabilities-manually"><span class="header-section-number">4.11.9.1</span> Generate Posterior Probabilities Manually</h4>
<p>Generate posterior probability of the event using the estimates and their associated posterior distributions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> hofit2 <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(b_Intercept, b_CAVG, b_RACEOthers) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CAVG =</span> <span class="fu">list</span>(<span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">4000</span>, <span class="dv">10</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(CAVG)) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RACE =</span> <span class="fu">list</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(RACE)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PRED =</span> <span class="fu">exp</span>(b_Intercept <span class="sc">+</span> b_CAVG <span class="sc">*</span> CAVG <span class="sc">+</span> b_RACEOthers <span class="sc">*</span> RACE)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(b_Intercept <span class="sc">+</span> b_CAVG <span class="sc">*</span> CAVG <span class="sc">+</span> b_RACEOthers <span class="sc">*</span> RACE))) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CAVG, RACE) <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pred_m =</span> <span class="fu">mean</span>(PRED, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">pred_low =</span> <span class="fu">quantile</span>(PRED, <span class="at">prob =</span> <span class="fl">0.025</span>),</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">pred_high =</span> <span class="fu">quantile</span>(PRED, <span class="at">prob =</span> <span class="fl">0.975</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RACE =</span> <span class="fu">factor</span>(RACE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Others"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot The Probability of the Event vs Average Concentration</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>out <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> CAVG, <span class="at">y =</span> pred_m, <span class="at">color =</span> <span class="fu">factor</span>(RACE))) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> pred_low, <span class="at">ymax =</span> pred_high, <span class="at">fill =</span> <span class="fu">factor</span>(RACE)), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted Probability of the Event</span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Average Concentration until the Event (mg/L)"</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generate-posterior-probabilities-using-helper-functions-from-brms-and-tidybayes" class="level4" data-number="4.11.9.2">
<h4 data-number="4.11.9.2" class="anchored" data-anchor-id="generate-posterior-probabilities-using-helper-functions-from-brms-and-tidybayes"><span class="header-section-number">4.11.9.2</span> Generate Posterior Probabilities Using Helper Functions from <code>brms</code> and <code>tidybayes</code></h4>
<p>Generate posterior probability of the event using the estimates and their associated posterior distributions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> hofit2 <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epred_draws</span>(<span class="at">newdata =</span> <span class="fu">expand_grid</span>(<span class="at">CAVG =</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">4000</span>, <span class="at">by =</span> <span class="dv">10</span>), </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">RACE =</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Others"</span>)),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">value =</span> <span class="st">"PRED"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RACE =</span> <span class="fu">factor</span>(RACE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Others"</span>), </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Others"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot The Probability of the Event vs Average Concentration</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>out2 <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> CAVG, <span class="at">y =</span> PRED, <span class="at">color =</span> RACE, <span class="at">fill =</span> RACE), </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">.width =</span> <span class="fl">0.95</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted Probability of the Event</span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Average Concentration until the Event (mg/L)"</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./poppk.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Bayesian Approach to PK/PD using Stan and Torsten</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./installation.html" class="pagination-link">
        <span class="nav-page-text">Installation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>